<div class="container mt-1">
    <div *ngIf="hodnoceni != null">

        <div *ngIf="cislo != null && cislo > 0" class="ohodnoceni">
            <p>{{cislo}}/10</p>
        </div>
        <p class="pridat">Přidat hodnocení:</p>
        <div class="form mt-0">
            <form [formGroup]='hodnoceniForm' ngNativeValidate (ngSubmit)="validateBeforeSubmit()" autocomplete="off">
                <div class="form-group">
                    <textarea
                    type="text" class="form-control" formControlName='text' placeholder="názor (nepovinné)"></textarea>
                </div>

                <select
                [class.is-invalid]='hodnoceniForm.get("cislo").errors && hodnoceniForm.get("cislo").touched'
                class="custom-select" formControlName="cislo">
                    <option disabled hidden value="">vyberte ohodnocení</option>
                    <option *ngFor="let cislo of cisla">
                      {{cislo}}
                    </option>
                </select>
                <div *ngIf="hodnoceniForm.get('cislo').hasError('required')" class="invalid-feedback">Prosím vyplňte číselné hodnocení.</div>

                <div class="button">
                    <button class="btn btn-success mr-2" type="submit">Hodnotit</button>
                </div>
            </form>
        </div>
    
        <div *ngIf="hodnoceni.length > 0">
            <div class="list-group">
                <ul>
                    <ng-container *ngFor="let comment of hodnoceni">
                         <li  class="list-group-item border"> <!-- *ngIf="comment.text.length != 0" -->
                            <div *ngIf="this.idIsEditing != comment.id" class="koment container">
                                <div class="row">
                                    <div class="col-10">
                                        <p class="komentar">{{comment.text}}</p>
                                    </div>
                                    <div class="likeCount col-sm d-flex justify-content-end">
                                        <p>{{comment.studentsLikedBy.length}}</p>
                                        <button class="like btn btn-light" (click)="likeOrRemoveLike(comment.id)"><i *ngIf="hodnoceniLiked.includes(comment.id)" class="fas fa-heart"></i>
                                            <i *ngIf="!hodnoceniLiked.includes(comment.id)" class="far fa-heart"></i></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <p class="komentar">{{comment.rating}}/10</p>
                                </div>
                                <div class="row">
                                    <p class="info">{{comment.created}}</p>
                                </div>
                                <div class="row" *ngIf="comment.studentName == student.name">
                                    <button (click)='editRating(comment.id, comment.text)' type="button" class="btn btn-primary">Upravit</button>
                                    <button (click)='deleteRating(comment.id)' type="button" class="btn btn-danger">Smazat</button>
                                </div>
                            </div>

                            <div *ngIf="this.idIsEditing == comment.id" class="editace">
                                <form [formGroup]='editForm' ngNativeValidate (ngSubmit)="saveEdit(comment.id)" autocomplete="off">
                                    <div class="form-group">
                                        <textarea
                                        type="text" class="form-control" formControlName='text' [(ngModel)]='textIsEditing'></textarea>
                                    </div>
                    
                                    <div class="button">
                                        <button class="btn btn-info mr-2" (click)='cancelEdit()' type="button">Zrušit</button>
                                        <button class="btn btn-success mr-2" type="submit">Uložit</button>
                                    </div>
                                </form>
                            </div>                            
                        </li>  
                    </ng-container>
                </ul>
            </div>

            <div class="d-flex justify-content-center mt-4">
                <pagination 
                    [maxSize]="5"
                    [boundaryLinks]="true" 
                    [totalItems]="pagination.totalItems"
                    [itemsPerPage]="pagination.itemsPerPage"
                    [(ngModel)]="pagination.currentPage"
                    (pageChanged)="pageChanged($event)"
                    previousText="&lsaquo;" 
                    nextText="&rsaquo;" 
                    firstText="&laquo;" 
                    lastText="&raquo;"> 
                </pagination>
            </div>
        </div>
        <div class="prvni" *ngIf="hodnoceni?.length == 0 && pagination.allItems == 0">
            <p>Buďte první kdo přidá hodnocení. 1 - nejhorší, 10 - nejlepší</p>
        </div>
        <div class="prvni" *ngIf="hodnoceni?.length == 0 && pagination.allItems > 0">
            <p>Žádné hodnocení neodpovídá filtrům.</p>
        </div>
    </div>
    
</div>

